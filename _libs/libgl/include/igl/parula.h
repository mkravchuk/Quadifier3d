// This file is part of libigl, a simple c++ geometry processing library.
// 
// Copyright (C) 2015 Alec Jacobson <alecjacobson@gmail.com>
// 
// This Source Code Form is subject to the terms of the Mozilla Public License 
// v. 2.0. If a copy of the MPL was not distributed with this file, You can 
// obtain one at http://mozilla.org/MPL/2.0/.
#ifndef IGL_PARULA_H
#define IGL_PARULA_H
#include "igl_inline.h"
//#ifndef IGL_NO_EIGEN
#  include <Eigen/Dense>
//#endif
namespace igl
{
  // PARULA like MATLAB's parula
  //
  // Inputs:
  //   m  number of colors 
  // Outputs:
  //   J  m by list of RGB colors between 0 and 1
  //
  // Wrapper for directly computing [r,g,b] values for a given factor f between
  // 0 and 1
  //
  // Inputs:
  //   f  factor determining color value as if 0 was min and 1 was max
  // Outputs:
  //   r  red value
  //   g  green value
  //   b  blue value
  template <typename T>
  IGL_INLINE void parula(const T f, T * rgb);
  template <typename T>
  IGL_INLINE void parula(const T f, T & r, T & g, T & b);
  // Inputs:
  //   Z  #Z list of factors 
  //   normalize  whether to normalize Z to be tightly between [0,1]
  // Outputs:
  //   C  #C by 3 list of rgb colors
  template <typename DerivedZ, typename DerivedC>
  IGL_INLINE void parula(
    const Eigen::PlainObjectBase<DerivedZ> & Z,
    const bool normalize,
    Eigen::PlainObjectBase<DerivedC> & C);
  // Inputs:
  //   min_Z  value at blue
  //   max_Z  value at red
  template <typename DerivedZ, typename DerivedC>
  IGL_INLINE void parula(
    const Eigen::PlainObjectBase<DerivedZ> & Z,
    const double min_Z,
    const double max_Z,
    Eigen::PlainObjectBase<DerivedC> & C);
  // adapted from parula.m
  const Eigen::Matrix<float,256,4> PARULA_COLOR_MAP = 
    (Eigen::Matrix<float,256,4>()<<
      0.2081f,0.1663f,0.5292f,1.f,
      0.2091f,0.1721f,0.5411f,1.f,
      0.2101f,0.1779f,0.553f,1.f,
      0.2109f,0.1837f,0.565f,1.f,
      0.2116f,0.1895f,0.5771f,1.f,
      0.2121f,0.1954f,0.5892f,1.f,
      0.2124f,0.2013f,0.6013f,1.f,
      0.2125f,0.2072f,0.6135f,1.f,
      0.2123f,0.2132f,0.6258f,1.f,
      0.2118f,0.2192f,0.6381f,1.f,
      0.2111f,0.2253f,0.6505f,1.f,
      0.2099f,0.2315f,0.6629f,1.f,
      0.2084f,0.2377f,0.6753f,1.f,
      0.2063f,0.244f,0.6878f,1.f,
      0.2038f,0.2503f,0.7003f,1.f,
      0.2006f,0.2568f,0.7129f,1.f,
      0.1968f,0.2632f,0.7255f,1.f,
      0.1921f,0.2698f,0.7381f,1.f,
      0.1867f,0.2764f,0.7507f,1.f,
      0.1802f,0.2832f,0.7634f,1.f,
      0.1728f,0.2902f,0.7762f,1.f,
      0.1641f,0.2975f,0.789f,1.f,
      0.1541f,0.3052f,0.8017f,1.f,
      0.1427f,0.3132f,0.8145f,1.f,
      0.1295f,0.3217f,0.8269f,1.f,
      0.1147f,0.3306f,0.8387f,1.f,
      0.0986f,0.3397f,0.8495f,1.f,
      0.0816f,0.3486f,0.8588f,1.f,
      0.0646f,0.3572f,0.8664f,1.f,
      0.0482f,0.3651f,0.8722f,1.f,
      0.0329f,0.3724f,0.8765f,1.f,
      0.0213f,0.3792f,0.8796f,1.f,
      0.0136f,0.3853f,0.8815f,1.f,
      0.0086f,0.3911f,0.8827f,1.f,
      0.006f,0.3965f,0.8833f,1.f,
      0.0051f,0.4017f,0.8834f,1.f,
      0.0054f,0.4066f,0.8831f,1.f,
      0.0067f,0.4113f,0.8825f,1.f,
      0.0089f,0.4159f,0.8816f,1.f,
      0.0116f,0.4203f,0.8805f,1.f,
      0.0148f,0.4246f,0.8793f,1.f,
      0.0184f,0.4288f,0.8779f,1.f,
      0.0223f,0.4329f,0.8763f,1.f,
      0.0264f,0.437f,0.8747f,1.f,
      0.0306f,0.441f,0.8729f,1.f,
      0.0349f,0.4449f,0.8711f,1.f,
      0.0394f,0.4488f,0.8692f,1.f,
      0.0437f,0.4526f,0.8672f,1.f,
      0.0477f,0.4564f,0.8652f,1.f,
      0.0514f,0.4602f,0.8632f,1.f,
      0.0549f,0.464f,0.8611f,1.f,
      0.0582f,0.4677f,0.8589f,1.f,
      0.0612f,0.4714f,0.8568f,1.f,
      0.064f,0.4751f,0.8546f,1.f,
      0.0666f,0.4788f,0.8525f,1.f,
      0.0689f,0.4825f,0.8503f,1.f,
      0.071f,0.4862f,0.8481f,1.f,
      0.0729f,0.4899f,0.846f,1.f,
      0.0746f,0.4937f,0.8439f,1.f,
      0.0761f,0.4974f,0.8418f,1.f,
      0.0773f,0.5012f,0.8398f,1.f,
      0.0782f,0.5051f,0.8378f,1.f,
      0.0789f,0.5089f,0.8359f,1.f,
      0.0794f,0.5129f,0.8341f,1.f,
      0.0795f,0.5169f,0.8324f,1.f,
      0.0793f,0.521f,0.8308f,1.f,
      0.0788f,0.5251f,0.8293f,1.f,
      0.0778f,0.5295f,0.828f,1.f,
      0.0764f,0.5339f,0.827f,1.f,
      0.0746f,0.5384f,0.8261f,1.f,
      0.0724f,0.5431f,0.8253f,1.f,
      0.0698f,0.5479f,0.8247f,1.f,
      0.0668f,0.5527f,0.8243f,1.f,
      0.0636f,0.5577f,0.8239f,1.f,
      0.06f,0.5627f,0.8237f,1.f,
      0.0562f,0.5677f,0.8234f,1.f,
      0.0523f,0.5727f,0.8231f,1.f,
      0.0484f,0.5777f,0.8228f,1.f,
      0.0445f,0.5826f,0.8223f,1.f,
      0.0408f,0.5874f,0.8217f,1.f,
      0.0372f,0.5922f,0.8209f,1.f,
      0.0342f,0.5968f,0.8198f,1.f,
      0.0317f,0.6012f,0.8186f,1.f,
      0.0296f,0.6055f,0.8171f,1.f,
      0.0279f,0.6097f,0.8154f,1.f,
      0.0265f,0.6137f,0.8135f,1.f,
      0.0255f,0.6176f,0.8114f,1.f,
      0.0248f,0.6214f,0.8091f,1.f,
      0.0243f,0.625f,0.8066f,1.f,
      0.0239f,0.6285f,0.8039f,1.f,
      0.0237f,0.6319f,0.801f,1.f,
      0.0235f,0.6352f,0.798f,1.f,
      0.0233f,0.6384f,0.7948f,1.f,
      0.0231f,0.6415f,0.7916f,1.f,
      0.023f,0.6445f,0.7881f,1.f,
      0.0229f,0.6474f,0.7846f,1.f,
      0.0227f,0.6503f,0.781f,1.f,
      0.0227f,0.6531f,0.7773f,1.f,
      0.0232f,0.6558f,0.7735f,1.f,
      0.0238f,0.6585f,0.7696f,1.f,
      0.0246f,0.6611f,0.7656f,1.f,
      0.0263f,0.6637f,0.7615f,1.f,
      0.0282f,0.6663f,0.7574f,1.f,
      0.0306f,0.6688f,0.7532f,1.f,
      0.0338f,0.6712f,0.749f,1.f,
      0.0373f,0.6737f,0.7446f,1.f,
      0.0418f,0.6761f,0.7402f,1.f,
      0.0467f,0.6784f,0.7358f,1.f,
      0.0516f,0.6808f,0.7313f,1.f,
      0.0574f,0.6831f,0.7267f,1.f,
      0.0629f,0.6854f,0.7221f,1.f,
      0.0692f,0.6877f,0.7173f,1.f,
      0.0755f,0.6899f,0.7126f,1.f,
      0.082f,0.6921f,0.7078f,1.f,
      0.0889f,0.6943f,0.7029f,1.f,
      0.0956f,0.6965f,0.6979f,1.f,
      0.1031f,0.6986f,0.6929f,1.f,
      0.1104f,0.7007f,0.6878f,1.f,
      0.118f,0.7028f,0.6827f,1.f,
      0.1258f,0.7049f,0.6775f,1.f,
      0.1335f,0.7069f,0.6723f,1.f,
      0.1418f,0.7089f,0.6669f,1.f,
      0.1499f,0.7109f,0.6616f,1.f,
      0.1585f,0.7129f,0.6561f,1.f,
      0.1671f,0.7148f,0.6507f,1.f,
      0.1758f,0.7168f,0.6451f,1.f,
      0.1849f,0.7186f,0.6395f,1.f,
      0.1938f,0.7205f,0.6338f,1.f,
      0.2033f,0.7223f,0.6281f,1.f,
      0.2128f,0.7241f,0.6223f,1.f,
      0.2224f,0.7259f,0.6165f,1.f,
      0.2324f,0.7275f,0.6107f,1.f,
      0.2423f,0.7292f,0.6048f,1.f,
      0.2527f,0.7308f,0.5988f,1.f,
      0.2631f,0.7324f,0.5929f,1.f,
      0.2735f,0.7339f,0.5869f,1.f,
      0.2845f,0.7354f,0.5809f,1.f,
      0.2953f,0.7368f,0.5749f,1.f,
      0.3064f,0.7381f,0.5689f,1.f,
      0.3177f,0.7394f,0.563f,1.f,
      0.3289f,0.7406f,0.557f,1.f,
      0.3405f,0.7417f,0.5512f,1.f,
      0.352f,0.7428f,0.5453f,1.f,
      0.3635f,0.7438f,0.5396f,1.f,
      0.3753f,0.7446f,0.5339f,1.f,
      0.3869f,0.7454f,0.5283f,1.f,
      0.3986f,0.7461f,0.5229f,1.f,
      0.4103f,0.7467f,0.5175f,1.f,
      0.4218f,0.7473f,0.5123f,1.f,
      0.4334f,0.7477f,0.5072f,1.f,
      0.4447f,0.7482f,0.5021f,1.f,
      0.4561f,0.7485f,0.4972f,1.f,
      0.4672f,0.7487f,0.4924f,1.f,
      0.4783f,0.7489f,0.4877f,1.f,
      0.4892f,0.7491f,0.4831f,1.f,
      0.5f,0.7491f,0.4786f,1.f,
      0.5106f,0.7492f,0.4741f,1.f,
      0.5212f,0.7492f,0.4698f,1.f,
      0.5315f,0.7491f,0.4655f,1.f,
      0.5418f,0.749f,0.4613f,1.f,
      0.5519f,0.7489f,0.4571f,1.f,
      0.5619f,0.7487f,0.4531f,1.f,
      0.5718f,0.7485f,0.449f,1.f,
      0.5816f,0.7482f,0.4451f,1.f,
      0.5913f,0.7479f,0.4412f,1.f,
      0.6009f,0.7476f,0.4374f,1.f,
      0.6103f,0.7473f,0.4335f,1.f,
      0.6197f,0.7469f,0.4298f,1.f,
      0.629f,0.7465f,0.4261f,1.f,
      0.6382f,0.746f,0.4224f,1.f,
      0.6473f,0.7456f,0.4188f,1.f,
      0.6564f,0.7451f,0.4152f,1.f,
      0.6653f,0.7446f,0.4116f,1.f,
      0.6742f,0.7441f,0.4081f,1.f,
      0.683f,0.7435f,0.4046f,1.f,
      0.6918f,0.743f,0.4011f,1.f,
      0.7004f,0.7424f,0.3976f,1.f,
      0.7091f,0.7418f,0.3942f,1.f,
      0.7176f,0.7412f,0.3908f,1.f,
      0.7261f,0.7405f,0.3874f,1.f,
      0.7346f,0.7399f,0.384f,1.f,
      0.743f,0.7392f,0.3806f,1.f,
      0.7513f,0.7385f,0.3773f,1.f,
      0.7596f,0.7378f,0.3739f,1.f,
      0.7679f,0.7372f,0.3706f,1.f,
      0.7761f,0.7364f,0.3673f,1.f,
      0.7843f,0.7357f,0.3639f,1.f,
      0.7924f,0.735f,0.3606f,1.f,
      0.8005f,0.7343f,0.3573f,1.f,
      0.8085f,0.7336f,0.3539f,1.f,
      0.8166f,0.7329f,0.3506f,1.f,
      0.8246f,0.7322f,0.3472f,1.f,
      0.8325f,0.7315f,0.3438f,1.f,
      0.8405f,0.7308f,0.3404f,1.f,
      0.8484f,0.7301f,0.337f,1.f,
      0.8563f,0.7294f,0.3336f,1.f,
      0.8642f,0.7288f,0.33f,1.f,
      0.872f,0.7282f,0.3265f,1.f,
      0.8798f,0.7276f,0.3229f,1.f,
      0.8877f,0.7271f,0.3193f,1.f,
      0.8954f,0.7266f,0.3156f,1.f,
      0.9032f,0.7262f,0.3117f,1.f,
      0.911f,0.7259f,0.3078f,1.f,
      0.9187f,0.7256f,0.3038f,1.f,
      0.9264f,0.7256f,0.2996f,1.f,
      0.9341f,0.7256f,0.2953f,1.f,
      0.9417f,0.7259f,0.2907f,1.f,
      0.9493f,0.7264f,0.2859f,1.f,
      0.9567f,0.7273f,0.2808f,1.f,
      0.9639f,0.7285f,0.2754f,1.f,
      0.9708f,0.7303f,0.2696f,1.f,
      0.9773f,0.7326f,0.2634f,1.f,
      0.9831f,0.7355f,0.257f,1.f,
      0.9882f,0.739f,0.2504f,1.f,
      0.9922f,0.7431f,0.2437f,1.f,
      0.9952f,0.7476f,0.2373f,1.f,
      0.9973f,0.7524f,0.231f,1.f,
      0.9986f,0.7573f,0.2251f,1.f,
      0.9991f,0.7624f,0.2195f,1.f,
      0.999f,0.7675f,0.2141f,1.f,
      0.9985f,0.7726f,0.209f,1.f,
      0.9976f,0.7778f,0.2042f,1.f,
      0.9964f,0.7829f,0.1995f,1.f,
      0.995f,0.788f,0.1949f,1.f,
      0.9933f,0.7931f,0.1905f,1.f,
      0.9914f,0.7981f,0.1863f,1.f,
      0.9894f,0.8032f,0.1821f,1.f,
      0.9873f,0.8083f,0.178f,1.f,
      0.9851f,0.8133f,0.174f,1.f,
      0.9828f,0.8184f,0.17f,1.f,
      0.9805f,0.8235f,0.1661f,1.f,
      0.9782f,0.8286f,0.1622f,1.f,
      0.9759f,0.8337f,0.1583f,1.f,
      0.9736f,0.8389f,0.1544f,1.f,
      0.9713f,0.8441f,0.1505f,1.f,
      0.9692f,0.8494f,0.1465f,1.f,
      0.9672f,0.8548f,0.1425f,1.f,
      0.9654f,0.8603f,0.1385f,1.f,
      0.9638f,0.8659f,0.1343f,1.f,
      0.9623f,0.8716f,0.1301f,1.f,
      0.9611f,0.8774f,0.1258f,1.f,
      0.96f,0.8834f,0.1215f,1.f,
      0.9593f,0.8895f,0.1171f,1.f,
      0.9588f,0.8958f,0.1126f,1.f,
      0.9586f,0.9022f,0.1082f,1.f,
      0.9587f,0.9088f,0.1036f,1.f,
      0.9591f,0.9155f,0.099f,1.f,
      0.9599f,0.9225f,0.0944f,1.f,
      0.961f,0.9296f,0.0897f,1.f,
      0.9624f,0.9368f,0.085f,1.f,
      0.9641f,0.9443f,0.0802f,1.f,
      0.9662f,0.9518f,0.0753f,1.f,
      0.9685f,0.9595f,0.0703f,1.f,
      0.971f,0.9673f,0.0651f,1.f,
      0.9736f,0.9752f,0.0597f,1.f,
      0.9763f,0.9831f,0.0538f,1.f).finished();
};

#ifndef IGL_STATIC_LIBRARY
#  include "parula.cpp"
#endif

#endif

